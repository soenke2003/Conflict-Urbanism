<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Map Comparison Slider</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Mapbox GL JS -->
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.js"></script>
    
    <!-- Comparison Plugin -->
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-compare/v0.4.0/mapbox-gl-compare.css">
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-compare/v0.4.0/mapbox-gl-compare.js"></script>

    <style>
        body { 
            margin: 0; 
            padding: 0; 
            overflow: hidden;
        }
        #comparison-container {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
        }
        .map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
        .layer-controls {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255,255,255,0.9);
            padding: 10px;
            border-radius: 4px;
            z-index: 1;
            max-height: 80vh;
            overflow-y: auto;
            font-family: Arial, sans-serif;
        }
        .layer-controls button {
            display: block;
            margin: 5px 0;
            padding: 8px;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="layer-controls">
        <h3>Left Map Layers</h3>
        <button onclick="toggleLayer(leftMap, 'Reported Education and Child Welfare Services')">Education & Child Welfare</button>
        <button onclick="toggleLayer(leftMap, 'Reported Health and Human Services Facilities')">Health & Human Services</button>
        <button onclick="toggleLayer(leftMap, 'Reported Core Infrastructure')">Core Infrastructure</button>
        <button onclick="toggleLayer(leftMap, 'Reported Sites in the Adminstration of Government')">Government Admin</button>
        <button onclick="toggleLayer(leftMap, 'Reported Public Safety and Emergency Services')">Public Safety</button>
        <button onclick="toggleLayer(leftMap, 'Reported Libraries and Cultural Program Sites')">Libraries & Cultural</button>
        <button onclick="toggleLayer(leftMap, 'Reported Parks and Gardens in Redhook')">Parks & Gardens</button>
        <button onclick="toggleLayer(leftMap, 'Team Researched Activity Sites')">Research Sites</button>
        <button onclick="toggleLayer(leftMap, 'Red Hook Houses')">Red Hook Houses</button>
        <button onclick="toggleLayer(leftMap, 'New Utrecht and South Brooklyn High Schools')">High Schools</button>
        
        <h3>Right Map Layers</h3>
        <button onclick="toggleLayer(rightMap, 'Education Youth Services and Child Welfare Relevant to Client')">Education & Child Welfare</button>
        <button onclick="toggleLayer(rightMap, 'Health and Human Services For Client')">Health & Human Services</button>
        <button onclick="toggleLayer(rightMap, 'Core infrastructure relevant to client')">Core Infrastructure</button>
        <button onclick="toggleLayer(rightMap, 'Adminstration of Government Relevant to Client')">Government Admin</button>
        <button onclick="toggleLayer(rightMap, 'Public Safety and Emergency Services Relevant for Client')">Public Safety</button>
        <button onclick="toggleLayer(rightMap, 'Libraries and Cultural Programs Relevant For Client')">Libraries & Cultural</button>
        <button onclick="toggleLayer(rightMap, 'Gardens and Parks Relevant For Client')">Parks & Gardens</button>
        <button onclick="toggleLayer(rightMap, 'Team Researched Activity Sites')">Research Sites</button>
        <button onclick="toggleLayer(rightMap, 'Red Hook Houses')">Red Hook Houses</button>
        <button onclick="toggleLayer(rightMap, 'New Utrecht and South Brooklyn High Schools')">High Schools</button>
    </div>

    <div id="comparison-container">
        <div id="before" class="map"></div>
        <div id="after" class="map"></div>
    </div>

    <script>
        // Your Mapbox token
        mapboxgl.accessToken = 'pk.eyJ1Ijoic29lbmtlMjAwMyIsImEiOiJjbWFkMXJ0NDMwOW9vMmxxOGptNWZ5ZmZ1In0.mHKK_CmO3idngOXd8bHyBw';

        // Initialize before map (left side)
        const leftMap = new mapboxgl.Map({
            container: 'before',
            style: 'mapbox://styles/soenke2003/cmahoj8l500g701s81xvugkc8',
            center: [-74.0071077835969, 40.67590824803115],
            zoom: 14
        });

        // Initialize after map (right side)
        const rightMap = new mapboxgl.Map({
            container: 'after',
            style: 'mapbox://styles/soenke2003/cmahqcpv800d501s1gx41gbdi',
            center: [-74.0071077835969, 40.67590824803115],
            zoom: 14
        });

        // Wait for maps to load before adding compare
        leftMap.on('load', function() {
            rightMap.on('load', function() {
                // Create the comparison slider (this creates the vertical slider that moves horizontally)
                const compare = new mapboxgl.Compare(leftMap, rightMap, {
                    // This makes the slider work with mouse movement
                    mousemove: true,
                    // This makes the slider vertical (moving horizontally)
                    orientation: 'vertical'
                });
            });
        });

        // Layer toggle function
        function toggleLayer(map, layerId) {
            try {
                const visibility = map.getLayoutProperty(layerId, 'visibility');
                map.setLayoutProperty(
                    layerId,
                    'visibility',
                    visibility === 'visible' || visibility === undefined ? 'none' : 'visible'
                );
            } catch (error) {
                console.log(`Error toggling layer ${layerId}: ${error.message}`);
            }
        }
    </script>
</body>
</html>
